USE ROLE ACCOUNTADMIN;
USE WAREHOUSE COMPUTE_WH;
CREATE DATABASE IF NOT EXISTS VIEWS_DATABASE;
USE DATABASE VIEWS_DATABASE;
CREATE SCHEMA VIEW_SCHEMA;
USE SCHEMA VIEW_SCHEMA;

SELECT * FROM SALES_DATA;

SELECT *
FROM SALES_DATA
WHERE SHIP_MODE='First Class';

/*
    CREATE OR REPLACE VIEW VIEW_NAME
    AS
    (
        QUERY
    )
*/

--LET US CREATE VIEW FOR ONLY FIRST CLASS SHIP_MODE
CREATE OR REPLACE VIEW SHIP_MODE_FIRST_CLASS_ONLY
AS
SELECT *
FROM SALES_DATA
WHERE SHIP_MODE = 'First Class';

SELECT * FROM SHIP_MODE_FIRST_CLASS_ONLY;

CREATE OR REPLACE VIEW V2
AS
SELECT *
FROM SALES_DATA
WHERE SHIP_MODE = 'Second Class'
    AND COUNTRY='United States';

SELECT * FROM V2;

CREATE OR REPLACE VIEW DTAE
AS
SELECT * 
FROM SALES_DATA
WHERE ORDER_DATE BETWEEN '2014-02-01' AND  '2014-03-31';

SELECT * FROM DTAE
WHERE SHIP_MODE IN ('First Class','Same Day');
