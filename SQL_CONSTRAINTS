USE ROLE ACCOUNTADMIN;
USE WAREHOUSE COMPUTE_WH;

CREATE DATABASE IF NOT EXISTS GLOBAL_SUPERSTORE_2016;
CREATE SCHEMA IF NOT EXISTS SUPERSTORE_SCHEMA;
USE DATABASE GLOBAL_SUPERSTORE_2016;
USE SCHEMA SUPERSTORE_SCHEMA;

CREATE TABLE IF NOT EXISTS SALES(
    ROW_ID NUMBER NOT NULL UNIQUE,
    ORDER_ID VARCHAR(100),
    ORDER_DATE DATE,
    SHIP_DATE DATE,
    SHIP_MODE VARCHAR(50) NOT NULL,
    CUSTOMER_ID VARCHAR(100),
    CUSTOMER_NAME VARCHAR(100),
    SEGMENT VARCHAR(50),
    POSTAL_CODE NUMBER DEFAULT 0,
    CITY VARCHAR(100),
    STATE VARCHAR(100),
    COUNTRY VARCHAR(100),
    REGION VARCHAR(100),
    MARKET VARCHAR(100),
    PRODUCT_ID VARCHAR(100) NOT NULL,
    CATEGORY VARCHAR(50),
    SUB_CATEGORY VARCHAR(100),
    PRODUCT_NAME VARCHAR(100),
    SALES VARCHAR(100),
    QUANTITY NUMBER,
    DISCOUNT NUMBER,
    PROFIT VARCHAR(100),
    SHIPPING_COST NUMBER,
    ORDER_PRIORITY VARCHAR(100)
);

UPDATE SALES
SET POSTAL_CODE = DEFAULT
WHERE POSTAL_CODE IS NULL;

SELECT * FROM SALES;

--write a SQL QUERY TO SELECT THE ROW_ID, ORDER_ID,SHIP_MODE,CUSTOMER_ID FROM THE SALES
SELECT ROW_ID,ORDER_ID,SHIP_MODE,CUSTOMER_ID
FROM SALES;
--write a SQL QUERY TO DISPLAY  ROW_ID, ORDER_ID,CUSTOMER_NAME,SEGMENT,QUANTITY,SHIPPING_COST FROM THE SALES BUT NOT THAT THERE WAS AN EROOR IN THE QUANTITY YOU NEED TO ADD 1 VALUE TO THE PRESENT QUANTITY
SELECT ROW_ID,ORDER_ID,CUSTOMER_NAME,SEGMENT,QUANTITY +1 AS CORRECT_QUANTITY ,SHIPPING_COST
FROM SALES;
--WRITE A SQL QUERY TO RETRIVE ROW_ID,SEGMENT,COUNTRY,DISCOUNT,ORDER_PRIORITY FROM SALES. NOTE THAT YOU NEED TO DISPLAY ONLY THE ROW THAT ARE OF ORDER_PRIORITY HIGH, Here there is a mistake on discount column, discount should be discount current value * 5
SELECT 
    ROW_ID,
    SEGMENT,
    COUNTRY,
    DISCOUNT,
    DISCOUNT * 5 AS UPDATED_DISCOUNT,
    ORDER_PRIORITY
FROM SALES
WHERE ORDER_PRIORITY = 'High';

/*WRITE A SQL QUERY TO GET ROW_ID,ORDER_DATE,SHIP_MODE,CUSTOMER_NAME,SEGMENT,POSTAL_CODE,SHIPPING_COST
NOTE THAT WE NEED TO ONLY SEE THE ROWS/FILTERED DATA BASED ON WHERE SHIPPING COST IS LESS THAN 25 AND ORDER PRIORITY IS LOW. PLEASE RETURN THE TABLE IN DESCENDING ORDER BASED ON THE ROW_ID COLUMN
*/
SELECT 
    ROW_ID,
    ORDER_DATE,
    SHIP_MODE,
    CUSTOMER_NAME,
    SEGMENT,
    POSTAL_CODE,
    SHIPPING_COST,
    ORDER_PRIORITY
FROM SALES
WHERE 
    SHIPPING_COST < 25 
    AND 
    ORDER_PRIORITY='Low'
ORDER BY ROW_ID DESC
